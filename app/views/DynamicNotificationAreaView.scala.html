@*
 * Copyright 2025 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import models.DueAndOverdueReturnBannerScenario.Received
@import views.html.components.gds._

@this(
    h2: HeadingH2,
    link: link,
    paragraphBody: paragraphBody,
    paragraphBodyLink: paragraphBodyLink,
    sectionBreak: SectionBreak
)

@(
    maybeUktrBannerScenario: Option[DueAndOverdueReturnBannerScenario],
    maybePaymentBannerScenario: Option[OutstandingPaymentBannerScenario],
    isAgent: Boolean
)(implicit messages: Messages)

@maybeAgentKey = @{if(isAgent) ".agent" else ""}

@dueAndOverdueReturnsUrl = @{
    controllers.dueandoverduereturns.routes.DueAndOverdueReturnsController.onPageLoad.url
}

@viewOutstandingPaymentsUrl = @{
    controllers.payments.routes.OutstandingPaymentsController.onPageLoad.url
}

@insideSectionBreaks(content: Html) = {
    @sectionBreak(id=Some("notifications-break-begin"))
    @content
    @sectionBreak(id=Some("notifications-break-end"))
}

@(maybeUktrBannerScenario, maybePaymentBannerScenario) match {
  case (_, Some(Outstanding(amountOutstanding))) => {
      @insideSectionBreaks {
          @h2(
              message = messages(s"homepage.dna.accruingInterest$maybeAgentKey.title", formatAmount(amountOutstanding)),
              size = "m",
              id = Some("accruing-interest-notification-subheading")
          )
          @paragraphBody(
            message = messages(s"homepage.dna.accruingInterest$maybeAgentKey.body"),
            id = Some("accruing-interest-notification-body")
          )
          @paragraphBodyLink(
            message = messages("homepage.dna.accruingInterest.outstandingPayments.linkText"),
            linkUrl = viewOutstandingPaymentsUrl,
            linkId = Some("accruing-interest-notification-outstanding-payments-link")
          )
      }
  }
  case (None | Some(Received), _) => {}
  case (Some(scenario), _) => {
    @defining(
      scenario match {
          case DueAndOverdueReturnBannerScenario.Due => "Due"
          case DueAndOverdueReturnBannerScenario.Overdue => "Overdue"
          case DueAndOverdueReturnBannerScenario.Incomplete => "Incomplete"
      }
    ){ scenarioKey => @insideSectionBreaks {
        @h2(
            message = messages(s"homepage.dna.returnExpected$maybeAgentKey.$scenarioKey.title"),
            size = "m",
            id = Some("return-expected-notification-subheading")
        )
        @paragraphBody(
            message = messages(s"homepage.dna.returnExpected$maybeAgentKey.$scenarioKey.body"),
            id = Some("return-expected-notification-body")
        )
        @paragraphBodyLink(
            message = messages("homepage.dna.returnExpected.linkText"),
            linkUrl = dueAndOverdueReturnsUrl,
            linkId = Some("return-expected-notification-submission-link")
        )
    }}
  }
}
