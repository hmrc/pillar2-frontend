@*
 * Copyright 2025 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import models.DueAndOverdueReturnBannerScenario.{Overdue, Received}
@import views.html.components.gds._

@this(
    link: link,
)

@(
    maybeUktrBannerScenario: Option[DueAndOverdueReturnBannerScenario],
    maybePaymentBannerScenario: Option[OutstandingPaymentBannerScenario],
    isAgent: Boolean
)(implicit messages: Messages)

@maybeAgentKey = @{if(isAgent) ".agent" else ""}

@dueAndOverdueReturnsUrl = @{
    controllers.dueandoverduereturns.routes.DueAndOverdueReturnsController.onPageLoad.url
}

@viewOutstandingPaymentsUrl = @{
    controllers.payments.routes.OutstandingPaymentsController.onPageLoad.url
}

@insideSectionBreaks(content: Html) = {
    <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible" id="notifications-break-begin">
    @content
    <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible" id="notifications-break-end">
}

@(maybeUktrBannerScenario, maybePaymentBannerScenario) match {
  case (_, Some(Outstanding(amountOutstanding))) => {
      @insideSectionBreaks {
          <h2 class="govuk-heading-m" id="accruing-interest-notification-subheading">
              @messages(s"homepage.dna.accruingInterest$maybeAgentKey.title", formatAmount(amountOutstanding))
          </h2>
          <p class="govuk-body" id="accruing-interest-notification-body">
              @messages(s"homepage.dna.accruingInterest$maybeAgentKey.body")
          </p>
          <p class="govuk-body">
          @link(
              text = messages("homepage.dna.accruingInterest.outstandingPayments.linkText"),
              call = Call("GET", viewOutstandingPaymentsUrl),
              id = Some("accruing-interest-notification-outstanding-payments-link")
          )
          </p>
      }
  }
  case (None | Some(Received), _) => {}
  case (Some(scenario), _) => {
    @defining(
      scenario match {
          case DueAndOverdueReturnBannerScenario.Due => "Due"
          case DueAndOverdueReturnBannerScenario.Overdue => "Overdue"
          case DueAndOverdueReturnBannerScenario.Incomplete => "Incomplete"
      }
    ){ scenarioKey => @insideSectionBreaks {
        <h2 class="govuk-heading-m" id="return-expected-notification-subheading">
            @messages(s"homepage.dna.returnExpected$maybeAgentKey.$scenarioKey.title")
        </h2>
        <p class="govuk-body" id="return-expected-notification-body">
            @messages(s"homepage.dna.returnExpected$maybeAgentKey.$scenarioKey.body")
        </p>
        <p class="govuk-body">
            @link(
                text = messages("homepage.dna.returnExpected.linkText"),
                call = Call("GET", dueAndOverdueReturnsUrl),
                id = Some("return-expected-notification-submission-link")
            )
        </p>
    }}
  }
}
